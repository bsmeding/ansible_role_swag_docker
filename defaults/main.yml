---
swag__name: swag
swag__image: lscr.io/linuxserver/swag
swag__port_http: 80
swag__port_https: 443
swag__skip_setup: false  # Disable setup stage of SWAG image
swag__url: 'example.com'
swag__subdomains: 'www'
swag__validation: ''
# swag__certprovider: 'zerossl'   # optional
# swag__dnsplugin: 'cloudflare'   # optional
# swag__cloudflare_global_email:   # optional
# swag__cloudflare_global_api:   # optional
# swag__cloudflare_api_token:   # optional
swag__email: ''
swag__only_subdomains: false
# swag__extra_domain:
swag__staging: true  # Only usable when letsencrypt is used as provider
swag__docker_mods: 'linuxserver/mods:swag-cloudflare-real-ip'  # See https://github.com/linuxserver/docker-mods
swag__remove_existing_container: false
swag__remove_existing_home_dir: false  # ONLY FOR AUTOMATED TEST!! WILL REMOVE ALL DATA!!!!
swag__pull_image: true
swag__hide_sensitive_logs: true
swag__network_mode: 'default'
swag__network_cidr: '172.16.81.0/26'
swag__network: 'proxy'
swag__container_networks:
  - name: bridge
  - name: "{{ swag__network }}"
swag__purge_networks: false
swag__log_driver: json-file
# swag__log_options:
swag__home: "/opt/{{ swag__name }}"
swag__use_local_directories_instead_of_volumes: true  # Volumes not ready yet, onlye mapped folders
swag__directories:
  - path: "{{ swag__home }}"
    mode: "0760"
  - path: "{{ swag__home }}/config"
    mode: "0770"
  - path: "{{ swag__home }}/wwwroot"
    mode: "0770"
  - path: "{{ swag__home }}/tailscale"
    mode: "0700"  # Owner (root) only: Tailscale runs as root in container
    owner: root    # Tailscale runs as root, so files are created as root:root
    group: root
swag__ports:
  - "{{ swag__port_http }}:80"
  - "{{ swag__port_https }}:443"
swag__directory_volumes:
  - "{{ swag__home }}/config:/config"
  - "{{ swag__home }}/tailscale:/var/lib/tailscale"
  - "{{ swag__home }}/wwwroot:/opt/wwwroot"
swag__file_volumes:
  - "/var/run/docker.sock:/var/run/docker.sock:ro"
swag__default_env:
  TZ: "{{ container_time_zone | default('Europe/Paris') }}"
  PUID: "{{ (docker_uid|default(1040)) | string }}"
  PGID: "{{ (docker_gid|default(1001)) | string }}"
  URL: "{{ swag__url }}"
  SUBDOMAINS: "{{ swag__subdomains | default('www') }}"
  VALIDATION: "{{ swag__validation | default('') }}"
  CERTPROVIDER: "{{ swag__certprovider | default('') }}"
  DNSPLUGIN: "{{ swag__dnsplugin | default('') }}"
  EMAIL: "{{ swag__email | default('') }}"
  ONLY_SUBDOMAINS: "{{ swag__only_subdomains | default(false) | string }}"
  EXTRA_DOMAINS: "{{ swag__extra_domain | default('') }}"
  STAGING: "{{ swag__staging | default(false) | string }}"
  DOCKER_MODS: "{{ swag__docker_mods | default('') }}"
  CF_ZONE_ID: "{{ swag__cloudflare_zone_id | default('') }}"
  CF_ACCOUNT_ID: "{{ swag__cloudflare_account_id | default('') }}"
  CF_API_TOKEN: "{{ swag__cloudflare_api_token | default('') }}"
  TAILSCALE_STATE_DIR: "{{ swag__tailscale_state_dir | default('') }}"
swag__env: {}
swag__proxy_confs_subdomain: []

# Tailscale Real IP Configuration
swag__enable_tailscale_real_ip: false  # Enable Tailscale real IP extraction for nginx
swag__tailscale_network_cidr: '100.0.0.0/8'  # Tailscale network CIDR

# Tailscale Configuration
# Note: To prevent Tailscale from creating a new device on each container redeploy:
# 1. Use a REUSABLE auth key (not ephemeral) - create one in Tailscale admin console with "Reusable" option
# 2. Set TAILSCALE_HOSTNAME to a consistent value (e.g., "proxy")
# 3. Ensure TAILSCALE_STATE_DIR is set to /var/lib/tailscale (default, but can be overridden)
# The tailscale directory is automatically created in swag__directories to persist state
swag__tailscale_state_dir: '/var/lib/tailscale'  # Tailscale state directory inside container
